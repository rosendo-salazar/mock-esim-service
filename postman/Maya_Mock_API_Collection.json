{
  "info": {
    "_postman_id": "maya-mock-api-collection",
    "name": "Maya Mock API",
    "description": "Mock Maya Mobile eSIM API for testing fly-roamy-api",
    "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
  },
  "auth": {
    "type": "basic",
    "basic": [
      {
        "key": "username",
        "value": "{{api_key}}",
        "type": "string"
      },
      {
        "key": "password",
        "value": "{{api_secret}}",
        "type": "string"
      }
    ]
  },
  "variable": [
    {
      "key": "base_url",
      "value": "http://localhost:8082"
    },
    {
      "key": "api_key",
      "value": "maya_test_key"
    },
    {
      "key": "api_secret",
      "value": "maya_test_secret"
    },
    {
      "key": "test_esim_id",
      "value": ""
    },
    {
      "key": "test_bundle_id",
      "value": "bundle_usa_5gb_30d"
    }
  ],
  "item": [
    {
      "name": "01. Health & Auth",
      "item": [
        {
          "name": "Health Check (Public)",
          "request": {
            "auth": {
              "type": "noauth"
            },
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/v1/admin/health",
              "host": ["{{base_url}}"],
              "path": ["v1", "admin", "health"]
            }
          }
        },
        {
          "name": "Test Valid Auth",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/v1/connectivity/bundles?size=1",
              "host": ["{{base_url}}"],
              "path": ["v1", "connectivity", "bundles"],
              "query": [{"key": "size", "value": "1"}]
            }
          }
        },
        {
          "name": "Test Invalid Auth",
          "request": {
            "auth": {
              "type": "basic",
              "basic": [
                {"key": "username", "value": "wrong_key", "type": "string"},
                {"key": "password", "value": "wrong_secret", "type": "string"}
              ]
            },
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/v1/connectivity/bundles",
              "host": ["{{base_url}}"],
              "path": ["v1", "connectivity", "bundles"]
            }
          }
        }
      ]
    },
    {
      "name": "02. Bundles (Plans)",
      "item": [
        {
          "name": "List All Bundles",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/v1/connectivity/bundles",
              "host": ["{{base_url}}"],
              "path": ["v1", "connectivity", "bundles"]
            }
          }
        },
        {
          "name": "Get Bundle by ID",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/v1/connectivity/bundles/{{test_bundle_id}}",
              "host": ["{{base_url}}"],
              "path": ["v1", "connectivity", "bundles", "{{test_bundle_id}}"]
            }
          }
        },
        {
          "name": "Filter by Country (US)",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/v1/connectivity/bundles?country=us",
              "host": ["{{base_url}}"],
              "path": ["v1", "connectivity", "bundles"],
              "query": [{"key": "country", "value": "us"}]
            }
          }
        },
        {
          "name": "Filter by Region (Europe)",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/v1/connectivity/bundles?region=europe",
              "host": ["{{base_url}}"],
              "path": ["v1", "connectivity", "bundles"],
              "query": [{"key": "region", "value": "europe"}]
            }
          }
        },
        {
          "name": "Filter by Package Type (global)",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/v1/connectivity/bundles?packageType=global",
              "host": ["{{base_url}}"],
              "path": ["v1", "connectivity", "bundles"],
              "query": [{"key": "packageType", "value": "global"}]
            }
          }
        },
        {
          "name": "Bundle Not Found",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/v1/connectivity/bundles/nonexistent_bundle",
              "host": ["{{base_url}}"],
              "path": ["v1", "connectivity", "bundles", "nonexistent_bundle"]
            }
          }
        }
      ]
    },
    {
      "name": "03. eSIM Provisioning",
      "item": [
        {
          "name": "Provision New eSIM",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "if (pm.response.code === 201) {",
                  "    var jsonData = pm.response.json();",
                  "    pm.collectionVariables.set('test_esim_id', jsonData.esimId);",
                  "    console.log('Saved esimId:', jsonData.esimId);",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [{"key": "Content-Type", "value": "application/json"}],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"bundleId\": \"{{test_bundle_id}}\",\n  \"userEmail\": \"test@example.com\",\n  \"profileType\": \"consumer\",\n  \"metadata\": {\n    \"orderId\": \"order_{{$timestamp}}\",\n    \"userId\": \"user_123\"\n  }\n}"
            },
            "url": {
              "raw": "{{base_url}}/v1/connectivity/esims",
              "host": ["{{base_url}}"],
              "path": ["v1", "connectivity", "esims"]
            }
          }
        },
        {
          "name": "Provision with Invalid Bundle",
          "request": {
            "method": "POST",
            "header": [{"key": "Content-Type", "value": "application/json"}],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"bundleId\": \"invalid_bundle\",\n  \"userEmail\": \"test@example.com\"\n}"
            },
            "url": {
              "raw": "{{base_url}}/v1/connectivity/esims",
              "host": ["{{base_url}}"],
              "path": ["v1", "connectivity", "esims"]
            }
          }
        }
      ]
    },
    {
      "name": "04. eSIM Management",
      "item": [
        {
          "name": "Get eSIM Details",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/v1/connectivity/esims/{{test_esim_id}}",
              "host": ["{{base_url}}"],
              "path": ["v1", "connectivity", "esims", "{{test_esim_id}}"]
            }
          }
        },
        {
          "name": "List All eSIMs",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/v1/connectivity/esims",
              "host": ["{{base_url}}"],
              "path": ["v1", "connectivity", "esims"]
            }
          }
        },
        {
          "name": "List eSIMs by Status (active)",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/v1/connectivity/esims?status=active",
              "host": ["{{base_url}}"],
              "path": ["v1", "connectivity", "esims"],
              "query": [{"key": "status", "value": "active"}]
            }
          }
        },
        {
          "name": "eSIM Not Found",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/v1/connectivity/esims/nonexistent_esim",
              "host": ["{{base_url}}"],
              "path": ["v1", "connectivity", "esims", "nonexistent_esim"]
            }
          }
        }
      ]
    },
    {
      "name": "05. Multi-Plan (Top-Off)",
      "item": [
        {
          "name": "Attach Additional Bundle",
          "request": {
            "method": "POST",
            "header": [{"key": "Content-Type", "value": "application/json"}],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"bundleId\": \"bundle_usa_10gb_30d\",\n  \"activationType\": \"immediate\",\n  \"stackData\": true\n}"
            },
            "url": {
              "raw": "{{base_url}}/v1/connectivity/esims/{{test_esim_id}}/bundles",
              "host": ["{{base_url}}"],
              "path": ["v1", "connectivity", "esims", "{{test_esim_id}}", "bundles"]
            }
          }
        },
        {
          "name": "Get eSIM with Multiple Bundles",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/v1/connectivity/esims/{{test_esim_id}}",
              "host": ["{{base_url}}"],
              "path": ["v1", "connectivity", "esims", "{{test_esim_id}}"]
            }
          }
        }
      ]
    },
    {
      "name": "06. Usage Simulation",
      "item": [
        {
          "name": "Simulate Data Usage (100MB)",
          "request": {
            "method": "POST",
            "header": [{"key": "Content-Type", "value": "application/json"}],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"esimId\": \"{{test_esim_id}}\",\n  \"usageMB\": 100\n}"
            },
            "url": {
              "raw": "{{base_url}}/v1/admin/simulate/usage",
              "host": ["{{base_url}}"],
              "path": ["v1", "admin", "simulate", "usage"]
            }
          }
        },
        {
          "name": "Simulate Heavy Usage (5000MB)",
          "request": {
            "method": "POST",
            "header": [{"key": "Content-Type", "value": "application/json"}],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"esimId\": \"{{test_esim_id}}\",\n  \"usageMB\": 5000\n}"
            },
            "url": {
              "raw": "{{base_url}}/v1/admin/simulate/usage",
              "host": ["{{base_url}}"],
              "path": ["v1", "admin", "simulate", "usage"]
            }
          }
        }
      ]
    },
    {
      "name": "07. Admin Operations",
      "item": [
        {
          "name": "Get Statistics",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/v1/admin/statistics",
              "host": ["{{base_url}}"],
              "path": ["v1", "admin", "statistics"]
            }
          }
        },
        {
          "name": "Force Status Change (expired)",
          "request": {
            "method": "POST",
            "header": [{"key": "Content-Type", "value": "application/json"}],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"esimId\": \"{{test_esim_id}}\",\n  \"newStatus\": \"expired\",\n  \"reason\": \"Testing expiration flow\"\n}"
            },
            "url": {
              "raw": "{{base_url}}/v1/admin/simulate/status",
              "host": ["{{base_url}}"],
              "path": ["v1", "admin", "simulate", "status"]
            }
          }
        },
        {
          "name": "Seed Test Data",
          "request": {
            "method": "POST",
            "header": [],
            "url": {
              "raw": "{{base_url}}/v1/admin/seed",
              "host": ["{{base_url}}"],
              "path": ["v1", "admin", "seed"]
            }
          }
        },
        {
          "name": "Reset All Data",
          "request": {
            "method": "DELETE",
            "header": [],
            "url": {
              "raw": "{{base_url}}/v1/admin/reset",
              "host": ["{{base_url}}"],
              "path": ["v1", "admin", "reset"]
            }
          }
        }
      ]
    },
    {
      "name": "08. Deactivation",
      "item": [
        {
          "name": "Deactivate eSIM",
          "request": {
            "method": "DELETE",
            "header": [],
            "url": {
              "raw": "{{base_url}}/v1/connectivity/esims/{{test_esim_id}}",
              "host": ["{{base_url}}"],
              "path": ["v1", "connectivity", "esims", "{{test_esim_id}}"]
            }
          }
        }
      ]
    },
    {
      "name": "09. QR Codes",
      "item": [
        {
          "name": "Get QR Code Image",
          "request": {
            "auth": {"type": "noauth"},
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/qr/{{test_esim_id}}",
              "host": ["{{base_url}}"],
              "path": ["qr", "{{test_esim_id}}"]
            }
          }
        },
        {
          "name": "Get QR Code Base64",
          "request": {
            "auth": {"type": "noauth"},
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/qr/{{test_esim_id}}/base64",
              "host": ["{{base_url}}"],
              "path": ["qr", "{{test_esim_id}}", "base64"]
            }
          }
        }
      ]
    }
  ]
}
